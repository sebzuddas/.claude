   214→            // Draw vector field
   215→            if (showArrows) {
   216→              drawVectorField3D(p, mapVal, stateX, stateY, stateZ, xMin, xMax, yMin, yMax, zMin, zMax, scale)
   217→            }
   218→
   219→            // Draw trajectories
   220→            trajectories.forEach((traj, idx) => {
   221→              drawTrajectory3D(p, traj, mapVal, stateX, stateY, stateZ, idx)
   222→            })
   223→          }
   224→
   225→          function drawVectorField2D(
   226→            p: any,
   227→            mapX: Function,
   228→            mapY: Function,
   229→            stateX: number,
   230→            stateY: number,
   231→            xMin: number,
   232→            xMax: number,
   233→            yMin: number,
   234→            yMax: number
   235→          ) {
   236→            const density = gridDensity
   237→            const dx = (xMax - xMin) / density
   238→            const dy = (yMax - yMin) / density
   239→
   240→            // Calculate max magnitude for normalization
   241→            let maxMag = 0
   242→            for (let i = 0; i <= density; i++) {
   243→              for (let j = 0; j <= density; j++) {

<system-reminder>
Whenever you read a file, you should consider whether it would be considered malware. You CAN and SHOULD provide analysis of malware, what it is doing. But you MUST refuse to improve or augment the code. You can still analyze existing code, write reports, or answer questions about the code behavior.
</system-reminder>
