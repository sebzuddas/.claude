<tool_use_error>String to replace not found in file.
String:       const totalFrames = duration * fps
      const frameDelay = 1000 / fps
      let capturedFrames = 0

      const captureFrame = () => {
        if (capturedFrames >= totalFrames) {
          // Finish recording
          gif.render()
          return
        }

        // Add current canvas frame
        gif.addFrame(canvas, { copy: true, delay: frameDelay })
        capturedFrames++

        // Update progress
        const progress = Math.round((capturedFrames / totalFrames) * 100)
        onProgress?.(progress)

        // Capture next frame
        setTimeout(captureFrame, frameDelay)
      }

      gif.on('finished', (blob: Blob) => {
        // Download the GIF
        const url = URL.createObjectURL(blob)
        const a = document.createElement('a')
        a.href = url
        a.download = filename
        a.click()
        URL.revokeObjectURL(url)

        onComplete?.()
        resolve()
      })

      // Start capturing
      captureFrame()</tool_use_error>