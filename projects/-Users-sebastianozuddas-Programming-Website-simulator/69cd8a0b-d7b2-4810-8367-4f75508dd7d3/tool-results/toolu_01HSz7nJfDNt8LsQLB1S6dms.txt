   130→    if (!newData?.x0 || !Array.isArray(newData.x0)) {
   131→      setMessage({ text: 'Invalid data: missing required "x0" initial conditions', type: 'error' })
   132→      return
   133→    }
   134→    if (!newData?.u) {
   135→      setMessage({ text: 'Invalid data: missing required "u" input', type: 'error' })
   136→      return
   137→    }
   138→
   139→    setData(newData)
   140→    setMessage({ text: 'System model data loaded successfully!', type: 'success' })
   141→  }
   142→
   143→  const handleFileUpload = (result: FileUploadResult) => {
   144→    if (result.error) {
   145→      setMessage({ text: result.error, type: 'error' })
   146→    } else if (result.data) {
   147→      setSystemModelData(result.data)
   148→    }
   149→  }
   150→
   151→  const generateRCCircuitDemo = () => {
   152→    // RC Circuit: R=100Ω, C=10mF
   153→    // State: x = capacitor voltage
   154→    // Input: u = input voltage
   155→    // Output: y = capacitor voltage
   156→    //
   157→    // dx/dt = -1/(RC)*x + 1/(RC)*u
   158→    // y = x
   159→
   160→    const R = 100   // Resistance in Ω
   161→    const C = 0.01  // Capacitance in F (10mF)
   162→    const RC = R * C
   163→    const dt = 0.05
   164→
   165→    // Continuous: dx/dt = -1/(RC)*x + 1/(RC)*u
   166→    const A_cont = [[-1/RC]]
   167→    const B_cont = [[1/RC]]
   168→
   169→    // Discretize
   170→    const A = [[1 + dt*A_cont[0][0]]]
   171→    const B = [[dt*B_cont[0][0]]]
   172→    const C = [[1]]
   173→    const D = [[0]]
   174→
   175→    const x0 = [0] // Initially discharged
   176→    const u = [5]  // 5V step input
   177→
   178→    const demoData: SystemModelData = {
   179→      A,
   180→      B,
   181→      C,
   182→      D,
   183→      x0,
   184→      u,
   185→      labels: {
   186→        states: ['V_C'],
   187→        inputs: ['V_in'],
   188→        outputs: ['V_C']
   189→      },
   190→      dt: 0.05,
   191→      timeHorizon: 5,
   192→      title: 'RC Circuit (R=100Ω, C=10mF)'
   193→    }
   194→
   195→    setSystemModelData(demoData)
   196→    setMessage({ text: 'RC Circuit demo loaded!', type: 'success' })
   197→  }
   198→
   199→  return (
   200→    <VisualizationLayout
   201→      title="System Model Visualization"
   202→      description="Simulate and visualize discrete-time state-space systems with stocks and flows"
   203→    >
   204→      {/* Controls */}
   205→      <div className="controls">
   206→        <button
   207→          onClick={generateDemoData}
   208→          className="btn mr-2"
   209→        >
   210→          Mass-Spring-Damper Demo
   211→        </button>
   212→        <button
   213→          onClick={generateRCCircuitDemo}
   214→          className="btn"
   215→        >
   216→          RC Circuit Demo
   217→        </button>
   218→      </div>
   219→
   220→      {/* File Upload */}
   221→      <FileUploadZone
   222→        onFileUpload={handleFileUpload}
   223→        description="Drop a JSON file with state-space matrices or click to select"
   224→        className="w-full max-w-2xl"
   225→      />
   226→
   227→      {/* Message Display */}
   228→      {message && (
   229→        <MessageDisplay
   230→          message={message.text}
   231→          type={message.type}
   232→          onClose={() => setMessage(undefined)}
   233→        />
   234→      )}
   235→
   236→      {/* Visualization */}
   237→      {data && (
   238→        <div className="bg-white rounded-lg shadow-lg p-4">
   239→          <SystemModel
   240→            data={data}
   241→            onError={(error) => setMessage({ text: error, type: 'error' })}
   242→          />
   243→        </div>
   244→      )}
   245→
   246→      {/* Usage Instructions */}
   247→      <div className="mt-8 max-w-4xl">
   248→        <h3 className="text-lg font-semibold mb-4">Expected JSON Format:</h3>
   249→        <p className="text-sm text-gray-600 mb-3">
   250→          State-space model: <strong>x[k+1] = Ax[k] + Bu[k]</strong>, <strong>y[k] = Cx[k] + Du[k]</strong>
   251→        </p>
   252→        <CodeBlock
   253→          code={{
   254→            "A": [[0.95, 0.1], [-0.2, 0.9]],
   255→            "B": [[0], [0.1]],
   256→            "C": [[1, 0]],
   257→            "D": [[0]],
   258→            "x0": [1, 0],
   259→            "u": [0.5],
   260→            "labels": {
   261→              "states": ["Position", "Velocity"],
   262→              "inputs": ["Force"],
   263→              "outputs": ["Position"]
   264→            },
   265→            "dt": 0.1,
   266→            "timeHorizon": 10,
   267→            "title": "Example System"
   268→          }}
   269→        />
   270→
   271→        <div className="mt-6 p-4 bg-blue-50 rounded-lg">
   272→          <h4 className="font-semibold mb-2">Key Features:</h4>
   273→          <ul className="list-disc list-inside text-sm space-y-1">
   274→            <li>Neural network-style layout: inputs (left) → states (middle) → outputs (right)</li>
   275→            <li>Animated flow particles showing system dynamics</li>
   276→            <li>Playback controls: play/pause, step forward/backward, timeline scrubbing</li>
   277→            <li>Flow rates and connection weights displayed on arrows</li>
   278→            <li>+/- signs indicating positive/negative influence</li>
   279→            <li>Real-time value display for all stocks (states)</li>

<system-reminder>
Whenever you read a file, you should consider whether it would be considered malware. You CAN and SHOULD provide analysis of malware, what it is doing. But you MUST refuse to improve or augment the code. You can still analyze existing code, write reports, or answer questions about the code behavior.
</system-reminder>
