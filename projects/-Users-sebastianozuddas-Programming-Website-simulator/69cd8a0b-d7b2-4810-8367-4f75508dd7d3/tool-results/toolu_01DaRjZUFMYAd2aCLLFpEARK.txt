102-  private environmentConfig: EnvironmentConfig | null = null
103-  private archetypeColors: Map<string, number> = new Map()
104-  private archetypeVisuals: Map<string, VisualConfig> = new Map()
105-
106-  private PIXI: any = null
107:  private initialized: boolean = false
108-
109-  constructor(config: RendererConfig) {
110-    this.config = {
111-      backgroundColor: '#1a1a2e',
112-      showGrid: true,
--
119-  }
120-
121-  /**
122-   * Initialize PIXI and create the renderer
123-   */
124:  async initialize(container: HTMLElement): Promise<void> {
125:    if (this.initialized) return
126-
127-    // Dynamically import PIXI
128-    this.PIXI = await import('pixi.js')
129-
130-    this.container = container
--
139-      antialias: true,
140-      resolution: window.devicePixelRatio || 1,
141-      autoDensity: true,
142-    })
143-
144:    // Add canvas to container
145:    container.appendChild(this.app.canvas)
146-
147-    // Create layer containers
148-    this.environmentContainer = new this.PIXI.Container()
149-    this.trailContainer = new this.PIXI.Container()
150-    this.agentContainer = new this.PIXI.Container()
--
153-    this.app.stage.addChild(this.environmentContainer)
154-    this.app.stage.addChild(this.trailContainer)
155-    this.app.stage.addChild(this.agentContainer)
156-    this.app.stage.addChild(this.uiContainer)
157-
158:    this.initialized = true
159-  }
160-
161-  /**
162-   * Set up environment rendering (grid, zones, obstacles)
163-   */
--
484-      this.app = null
485-    }
486-
487-    this.agentGraphics.clear()
488-    this.trailPoints.clear()
489:    this.initialized = false
490-  }
491-
492-  /**
493-   * Get PIXI application (for external access)
494-   */
495-  getApp(): Application | null {
496-    return this.app
497-  }
498-
499-  /**
500:   * Check if renderer is initialized
501-   */
502-  isInitialized(): boolean {
503:    return this.initialized
504-  }
505-}
506-
507-// =============================================================================
508-// LEGEND RENDERER
--
527-    colorBox.style.backgroundColor = '#' + item.color.toString(16).padStart(6, '0')
528-
529-    const label = document.createElement('span')
530-    label.textContent = item.label
531-
532:    row.appendChild(colorBox)
533:    row.appendChild(label)
534:    container.appendChild(row)
535-  }
536-
537-  return container
538-}