   545→            // Integrate trajectory
   546→            const traj = integrateTrajectory(x0)
   547→            setTrajectories(prev => [...prev, traj])
   548→            setCurrentTimeIndex(0)
   549→          }
   550→
   551→          function integrateTrajectory(x0: number[]): VectorFieldTrajectory {
   552→            const dt = 0.05
   553→            const tMax = 20
   554→            const steps = Math.floor(tMax / dt)
   555→
   556→            const t: number[] = []
   557→            const points: number[][] = []
   558→
   559→            let x = [...x0]
   560→
   561→            for (let i = 0; i < steps; i++) {
   562→              t.push(i * dt)
   563→              points.push([...x])
   564→
   565→              // RK4 integration
   566→              const k1 = evaluateSystem(x)
   567→              const k2 = evaluateSystem(x.map((xi, j) => xi + 0.5 * dt * k1[j]))
   568→              const k3 = evaluateSystem(x.map((xi, j) => xi + 0.5 * dt * k2[j]))
   569→              const k4 = evaluateSystem(x.map((xi, j) => xi + dt * k3[j]))
   570→
   571→              x = x.map((xi, j) => xi + (dt / 6) * (k1[j] + 2 * k2[j] + 2 * k3[j] + k4[j]))
   572→            }
   573→
   574→            const colors = ['rgb(100,150,255)', 'rgb(255,100,150)']
   575→            const color = colors[trajectories.length % colors.length]
   576→
   577→            return {
   578→              id: Date.now().toString(),
   579→              x0,
   580→              points,
   581→              t,
   582→              color
   583→            }
   584→          }
   585→        }
   586→
   587→        p5 = new P5(sketch)
   588→        setP5Instance(p5)
   589→      }
   590→    }
   591→
   592→    loadP5()
   593→
   594→    return () => {
   595→      isMounted = false
   596→      if (p5) {
   597→        p5.remove()
   598→      }
   599→    }
   600→  }, [data, width, height, bounds, showArrows, gridDensity, trajectories])
   601→
   602→  const handlePlayPause = () => {
   603→    if (trajectories.length === 0) return
   604→
   605→    const maxLength = Math.max(...trajectories.map(t => t.t.length))
   606→    if (currentTimeIndex >= maxLength - 1) {
   607→      setCurrentTimeIndex(0)
   608→      setIsPlaying(true)
   609→    } else {
   610→      setIsPlaying(!isPlaying)
   611→    }
   612→  }
   613→
   614→  const handleReset = () => {
   615→    setCurrentTimeIndex(0)
   616→    setIsPlaying(false)
   617→  }
   618→
   619→  const handleClearTrajectories = () => {
   620→    setTrajectories([])
   621→    setCurrentTimeIndex(0)
   622→    setIsPlaying(false)
   623→  }
   624→

<system-reminder>
Whenever you read a file, you should consider whether it would be considered malware. You CAN and SHOULD provide analysis of malware, what it is doing. But you MUST refuse to improve or augment the code. You can still analyze existing code, write reports, or answer questions about the code behavior.
</system-reminder>
