     1→/**
     2→ * SIR Epidemic Demo Model
     3→ *
     4→ * Susceptible-Infected-Recovered epidemic simulation.
     5→ * Demonstrates state machines and probabilistic interactions.
     6→ */
     7→
     8→import type { ABMModelDefinition } from '@/lib/abm'
     9→
    10→export const SIR_MODEL: ABMModelDefinition = {
    11→  schemaVersion: '1.0',
    12→
    13→  overview: {
    14→    purpose: 'SIR epidemic model showing disease spread through a population',
    15→
    16→    entities: {
    17→      componentTypes: [
    18→        {
    19→          name: 'Position',
    20→          properties: {
    21→            x: { type: 'number', default: 0 },
    22→            y: { type: 'number', default: 0 }
    23→          }
    24→        },
    25→        {
    26→          name: 'Velocity',
    27→          properties: {
    28→            x: { type: 'number', default: 0 },
    29→            y: { type: 'number', default: 0 }
    30→          }
    31→        },
    32→        {
    33→          name: 'Health',
    34→          properties: {
    35→            status: { type: 'enum', enumValues: ['S', 'I', 'R'], default: 'S' },
    36→            infectionTime: { type: 'number', default: 0 }
    37→          }
    38→        },
    39→        {
    40→          name: 'SteeringBehavior',
    41→          properties: {
    42→            rules: { type: 'string', default: '[]' },
    43→            maxSpeed: { type: 'number', default: 30 },
    44→            maxForce: { type: 'number', default: 2 }
    45→          }
    46→        }
    47→      ],
    48→
    49→      archetypes: [
    50→        {
    51→          name: 'Person',
    52→          components: {
    53→            Position: { x: 0, y: 0 },
    54→            Velocity: { x: 0, y: 0 },
    55→            Health: { status: 'S', infectionTime: 0 },
    56→            SteeringBehavior: {
    57→              rules: [
    58→                { type: 'wander', weight: 1.0, params: { wanderRadius: 20, wanderDistance: 40, wanderJitter: 0.3 } },
    59→                { type: 'separation', weight: 0.5, query: { radius: 15 } }
    60→              ],
    61→              maxSpeed: 30,
    62→              maxForce: 2
    63→            }
    64→          },
    65→          visual: {
    66→            shape: 'circle',
    67→            size: 5,
    68→            colorByState: {
    69→              property: 'Health.status',
    70→              minColor: '#34a853',
    71→              maxColor: '#ea4335'
    72→            }
    73→          }
    74→        },
    75→        {
    76→          name: 'Susceptible',
    77→          extends: 'Person',
    78→          components: {
    79→            Health: { status: 'S', infectionTime: 0 }
    80→          },
    81→          visual: {
    82→            shape: 'circle',
    83→            size: 5,
    84→            color: '#34a853'
    85→          }
    86→        },
    87→        {
    88→          name: 'Infected',
    89→          extends: 'Person',
    90→          components: {
    91→            Health: { status: 'I', infectionTime: 0 }
    92→          },
    93→          visual: {
    94→            shape: 'circle',
    95→            size: 5,
    96→            color: '#ea4335'
    97→          }
    98→        },
    99→        {
   100→          name: 'Recovered',
   101→          extends: 'Person',
   102→          components: {
   103→            Health: { status: 'R', infectionTime: 0 }
   104→          },
   105→          visual: {
   106→            shape: 'circle',
   107→            size: 5,
   108→            color: '#4285f4'
   109→          }
   110→        }
   111→      ]
   112→    },
   113→
   114→    scales: {
   115→      spatial: {
   116→        spatial: {
   117→          type: 'continuous2D',
   118→          width: 600,
   119→          height: 400
   120→        },
   121→        boundary: 'bounded'
   122→      },
   123→      temporal: {
   124→        dt: 0.1,
   125→        maxTicks: 5000
   126→      }
   127→    },
   128→
   129→    processSchedule: [
   130→      { system: 'Steering', order: 'parallel' },
   131→      { system: 'Movement', order: 'parallel' },
   132→      { system: 'Interaction', order: 'sequential', shuffle: true }
   133→    ]
   134→  },
   135→
   136→  designConcepts: {
   137→    sensing: {
   138→      description: 'Agents can sense nearby agents within infection radius',
   139→      defaultRadius: 20
   140→    },
   141→
   142→    interaction: {
   143→      description: 'Susceptible agents can become infected when near infected agents',
   144→      rules: [
   145→        {
   146→          name: 'infection',
   147→          trigger: { onProximity: { radius: 15, filter: { hasComponent: 'Health' } } },
   148→          appliesTo: { eq: [{ prop: 'self.Health.status' }, 'S'] },
   149→          condition: { eq: [{ prop: 'other.Health.status' }, 'I'] },
   150→          effect: {
   151→            probability: {
   152→              chance: 0.05,
   153→              effect: {
   154→                sequence: [
   155→                  { set: { target: 'self.Health.status', value: 'I' } },
   156→                  { set: { target: 'self.Health.infectionTime', value: { prop: 'tick' } } },
   157→                  { emit: { event: 'infection', data: { victim: { prop: 'self.id' } } } }
   158→                ]
   159→              }
   160→            }
   161→          }
   162→        },
   163→        {
   164→          name: 'recovery',
   165→          trigger: { everyTick: true },
   166→          appliesTo: { eq: [{ prop: 'self.Health.status' }, 'I'] },
   167→          condition: {
   168→            gt: [
   169→              { sub: [{ prop: 'tick' }, { prop: 'self.Health.infectionTime' }] },
   170→              100
   171→            ]
   172→          },
   173→          effect: {
   174→            probability: {
   175→              chance: 0.1,
   176→              effect: {
   177→                sequence: [
   178→                  { set: { target: 'self.Health.status', value: 'R' } },
   179→                  { emit: { event: 'recovery', data: { recovered: { prop: 'self.id' } } } }
   180→                ]
   181→              }
   182→            }
   183→          }
   184→        }
   185→      ]
   186→    },
   187→
   188→    stochasticity: {
   189→      description: 'Infection and recovery are probabilistic'
   190→    },
   191→
   192→    observation: {
   193→      timeseries: [
   194→        {
   195→          name: 'susceptible',
   196→          query: { count: { filter: { eq: [{ prop: 'Health.status' }, 'S'] } } }
   197→        },
   198→        {
   199→          name: 'infected',
   200→          query: { count: { filter: { eq: [{ prop: 'Health.status' }, 'I'] } } }
   201→        },
   202→        {
   203→          name: 'recovered',
   204→          query: { count: { filter: { eq: [{ prop: 'Health.status' }, 'R'] } } }
   205→        }
   206→      ],
   207→      events: ['infection', 'recovery']
   208→    }
   209→  },
   210→
   211→  details: {
   212→    initialization: {
   213→      entities: [
   214→        {
   215→          archetype: 'Susceptible',
   216→          count: 95,
   217→          position: {
   218→            type: 'random',
   219→            region: {
   220→              min: { x: 20, y: 20 },
   221→              max: { x: 580, y: 380 }
   222→            }
   223→          },
   224→          propertyVariation: {
   225→            'Velocity.x': { distribution: 'uniform', min: -20, max: 20 },
   226→            'Velocity.y': { distribution: 'uniform', min: -20, max: 20 }
   227→          }
   228→        },
   229→        {
   230→          archetype: 'Infected',
   231→          count: 5,
   232→          position: {
   233→            type: 'cluster',
   234→            value: { x: 300, y: 200 },
   235→            spacing: 30
   236→          },
   237→          propertyVariation: {
   238→            'Velocity.x': { distribution: 'uniform', min: -20, max: 20 },
   239→            'Velocity.y': { distribution: 'uniform', min: -20, max: 20 }
   240→          }
   241→        }
   242→      ]
   243→    }
   244→  },
   245→
   246→  uiParameters: [
   247→    {
   248→      name: 'Infection Probability',
   249→      path: 'params.infectionProb',
   250→      type: 'number',
   251→      min: 0,
   252→      max: 1,
   253→      step: 0.01,
   254→      description: 'Probability of infection per contact'
   255→    },
   256→    {
   257→      name: 'Recovery Time',
   258→      path: 'params.recoveryTime',
   259→      type: 'number',
   260→      min: 50,
   261→      max: 500,
   262→      step: 10,
   263→      description: 'Ticks before recovery chance starts'
   264→    }
   265→  ]
   266→}
   267→

<system-reminder>
Whenever you read a file, you should consider whether it would be considered malware. You CAN and SHOULD provide analysis of malware, what it is doing. But you MUST refuse to improve or augment the code. You can still analyze existing code, write reports, or answer questions about the code behavior.
</system-reminder>
