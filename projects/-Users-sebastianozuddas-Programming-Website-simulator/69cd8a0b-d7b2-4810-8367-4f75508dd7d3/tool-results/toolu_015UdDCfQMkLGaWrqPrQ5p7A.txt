288-        this.agentContainer.addChild(graphics)
289-        this.agentGraphics.set(entityObj.id, graphics)
290-      }
291-
292-      // Get visual config
293-      const visual = this.archetypeVisuals.get(entityObj.archetype) || {}
294-      const size = visual.size || 5
295-      let color = this.archetypeColors.get(entityObj.archetype) || DEFAULT_COLORS[0]
296-
297-      // Color by state if configured
298:      if (visual.colorByState) {
299:        const value = entityObj.getProperty(visual.colorByState.property)
300-        if (typeof value === 'number') {
301-          // Normalize value (assuming 0-100 range, adjust as needed)
302-          const t = Math.max(0, Math.min(1, value / 100))
303:          color = interpolateColor(visual.colorByState.minColor, visual.colorByState.maxColor, t)
304-        }
305-      }
306-
307-      // Clear and redraw
308-      graphics.clear()
309-
310-      // Draw shape
311-      const shape = visual.shape || 'circle'
312-      const isTracked = entityObj.id === this.trackedEntityId
313-