    85→        }
    86→        return next
    87→      })
    88→    }, 50) // Update every 50ms
    89→
    90→    return () => clearInterval(interval)
    91→  }, [isPlaying])
    92→
    93→  // P5.js visualization
    94→  useEffect(() => {
    95→    let p5: any
    96→    let isMounted = true
    97→
    98→    const loadP5 = async () => {
    99→      if (typeof window !== 'undefined' && canvasRef.current) {
   100→        canvasRef.current.innerHTML = ''
   101→
   102→        const p5Module = await import('p5')
   103→        const P5 = p5Module.default
   104→
   105→        if (!isMounted) return
   106→
   107→        const sketch = (p: any) => {
   108→          let nodes: Node[] = []
   109→          let edges: Edge[] = []
   110→          let particles: Particle[] = []
   111→          const particlePool: Particle[] = []
   112→          let lastParticleSpawn = 0
   113→
   114→          p.setup = () => {
   115→            const canvas = p.createCanvas(width, height - 100) // Reserve space for controls
   116→            canvas.parent(canvasRef.current)
   117→            canvas.style('display', 'block')
   118→            canvas.style('margin', '0 auto')
   119→
   120→            p.textAlign(p.CENTER, p.CENTER)
   121→
   122→            // Initialize layout
   123→            if (simulationRef.current && data) {
   124→              const layout = createNeuralNetworkLayout(data, simulationRef.current, width, height - 100)
   125→              nodes = layout.nodes
   126→              edges = layout.edges
   127→
   128→              // Initialize particle pool
   129→              for (let i = 0; i < 100; i++) {
   130→                particlePool.push({
   131→                  edge: edges[0],
   132→                  progress: 0,
   133→                  active: false
   134→                })
   135→              }
   136→            }
   137→
   138→            p.frameRate(30)
   139→          }
   140→
   141→          p.draw = () => {
   142→            p.background(250)
   143→
   144→            if (simulationError) {
   145→              p.fill(200, 50, 50)
   146→              p.textSize(16)
   147→              p.textAlign(p.CENTER, p.CENTER)
   148→              p.text(simulationError, width / 2, height / 2)
   149→              return
   150→            }
   151→
   152→            if (!simulationRef.current || !data) {
   153→              p.fill(150)
   154→              p.textSize(16)

<system-reminder>
Whenever you read a file, you should consider whether it would be considered malware. You CAN and SHOULD provide analysis of malware, what it is doing. But you MUST refuse to improve or augment the code. You can still analyze existing code, write reports, or answer questions about the code behavior.
</system-reminder>
