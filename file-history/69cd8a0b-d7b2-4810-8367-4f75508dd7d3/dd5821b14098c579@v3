// Type definitions for the data visualization platform

export interface HeatMapData {
  data: number[][];
  title?: string;
  labels?: {
    x?: string[];
    y?: string[];
  };
  colorScale?: string;
}

export interface ScatterPlotData {
  points: Array<{
    x: number;
    y: number;
    label?: string;
  }>;
  title?: string;
  xLabel?: string;
  yLabel?: string;
}

export interface NetworkNode {
  id: string;
  label?: string;
  size?: number;
  color?: string;
  group?: number;
}

export interface NetworkEdge {
  source: string;
  target: string;
  weight?: number;
  directed?: boolean;
  label?: string;
}

export interface NetworkGraphData {
  nodes: NetworkNode[];
  edges: NetworkEdge[];
  title?: string;
  directed?: boolean;
}

export interface ParticleSystemConfig {
  modelType: 'particleSystem';
  parameters: {
    particleCount: number;
    gravity: number;
    damping: number;
    bounds?: {
      width: number;
      height: number;
    };
  };
  initialConditions?: {
    positions: string;
    velocities: string;
  };
  forces?: string[];
  title?: string;
}

export interface ParticleSystemData extends ParticleSystemConfig {
  // Alias for consistency with other visualization data types
}

export interface FlockingConfig {
  modelType: 'flocking';
  parameters: {
    boidCount: number;
    perceptionRadius: number;
    separationDistance: number;
    separationForce: number;
    alignmentForce: number;
    cohesionForce: number;
    maxSpeed: number;
    maxForce: number;
  };
  title?: string;
}

export interface FlockingData extends FlockingConfig {
  // Alias for consistency with other visualization data types
}

export interface SystemModelData {
  A: number[][];  // State matrix (n×n)
  B: number[][];  // Input matrix (n×m)
  C: number[][];  // Output matrix (p×n)
  D: number[][];  // Feedthrough matrix (p×m)
  x0: number[];   // Initial conditions
  u: number[] | number[][];  // Input sequence (constant or time-varying)
  labels?: {
    states?: string[];   // State variable names
    inputs?: string[];   // Input names
    outputs?: string[];  // Output names
  };
  dt?: number;          // Time step (default: 0.1)
  timeHorizon?: number; // Simulation time (0 = 300s default)
  title?: string;
}

// State space visualization data (simple format)
export interface StateSpaceData {
  t: number[];           // Time points
  x: number[][];         // State trajectories [timeStep][stateIndex]
  labels?: string[];     // State labels
  title?: string;        // Title for the visualization
}

// Complete export format from system simulator
export interface SystemSimulatorExport {
  metadata?: {
    title?: string;
    dt?: number;
    timeHorizon?: number;
    exportDate?: string;
  };
  system?: {
    A: number[][];
    B: number[][];
    C: number[][];
    D: number[][];
    x0: number[];
    u: number[] | number[][];
    labels?: {
      states?: string[];
      inputs?: string[];
      outputs?: string[];
    };
  };
  results: {
    t: number[];
    x: number[][];
    u: number[][];
    y: number[][];
  };
}

// Vector field visualization data
export interface VectorFieldData {
  // System definition
  A?: number[][];  // For linear systems: dx/dt = Ax
  f?: (x: number[]) => number[];  // For nonlinear systems: dx/dt = f(x)

  // Metadata
  labels?: string[];  // State labels
  title?: string;

  // Display options
  dimension?: 2 | 3;  // 2D or 3D visualization
  selectedStates?: number[];  // Which states to visualize (indices)
  otherStatesMode?: 'zero' | 'equilibrium' | 'custom';  // How to handle unselected states
  otherStatesValues?: number[];  // Custom values for unselected states

  // Bounds (auto-calculated or user-specified)
  bounds?: {
    min: number[];
    max: number[];
  };
}

// Trajectory data for vector field
export interface VectorFieldTrajectory {
  id: string;
  x0: number[];  // Initial condition
  points: number[][];  // Trajectory points [time][state]
  t: number[];  // Time points
  color: string;  // Display color
}

export interface ColorPalette {
  name: string;
  description?: string;
  colors: string[];
}

export interface Theme {
  name: string;
  colors: {
    primary: string;
    secondary: string;
    accent: string;
    background: string;
    surface: string;
    text: string;
    textSecondary: string;
    textLight: string;
    border: string;
    error: string;
    warning: string;
    success: string;
  };
  typography?: {
    fontFamily: string;
    fontSizes: Record<string, string>;
    fontWeights: Record<string, number>;
  };
}

export interface ThemeConfig {
  themes: Record<string, Theme>;
  colorPalettes: Record<string, ColorPalette>;
  visualizationDefaults: Record<string, {
    defaultPalette: string;
    fontSize: string;
    titleSize: string;
    labelSize?: string;
    pointColors?: string[];
  }>;
}

export interface VisualizationProps {
  data?: any;
  width?: number;
  height?: number;
  className?: string;
  onDataChange?: (data: any) => void;
  onError?: (error: string) => void;
}

export interface DataValidationResult {
  valid: boolean;
  errors: string[];
}

export interface FileUploadResult {
  data?: any;
  error?: string;
}

// P5.js related types
export interface P5Instance {
  setup: () => void;
  draw: () => void;
  windowResized?: () => void;
  mousePressed?: () => void;
  mouseMoved?: () => void;
  keyPressed?: () => void;
}

export type ColorTuple = [number, number, number];

export interface VisualizationState {
  data: any;
  isLoading: boolean;
  error: string | null;
  colorPalette: string;
  fontSize: number;
}